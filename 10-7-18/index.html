<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/component---src-layouts-index-js-77e2d164b005f18d2f68.js" as="script"/><link rel="preload" href="/component---src-templates-post-js-a9c836c780f858edfad9.js" as="script"/><link rel="preload" href="/path---10-7-18-b8790adc8aa4523eeade.js" as="script"/><link rel="preload" href="/app-10e773a9e8e479195e53.js" as="script"/><link rel="preload" href="/commons-b28cb5a1a06ec3a0e088.js" as="script"/><title data-react-helmet="true">David Crandall</title><meta data-react-helmet="true" name="description" content="David Crandall"/><meta data-react-helmet="true" name="keywords" content="David Crandall"/><style id="gatsby-inlined-css">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0;overflow-x:hidden}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern","liga","clig","calt";-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt"}img{max-width:100%;margin:0 0 1.45rem;padding:0}h1{font-size:2.25rem}h1,h2{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{margin:0 0 1.45rem 1.45rem;padding:0;list-style-position:outside;list-style-image:none}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{padding:0;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}pre,table{margin:0 0 1.45rem}table{padding:0;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0;padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{margin:0 0 calc(1.45rem - 1px);padding:0;background:rgba(0,0,0,.2);border:none;height:1px}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:0.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:0.725rem;margin-top:0.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:0.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:0;padding-top:.2em;padding-bottom:.2em;margin-right:.2rem}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="168227912"><!-- react-empty: 2 --><div class="sc-bdVaJa cFlHZR" data-reactid="3"><div class="sc-bwzfXH edKBDJ" data-reactid="4"><h1 style="margin:0;" data-reactid="5"><a style="color:#f1f1f1;text-decoration:none;" aria-current="false" href="/" data-reactid="6">David Crandall</a></h1><ul class="sc-htpNat isvRAV" data-reactid="7"><li data-reactid="8"><a aria-current="false" href="/blog" data-reactid="9">Blog</a></li><li data-reactid="10"><a href="https://mysterious-brushlands-44734.herokuapp.com/" data-reactid="11">Portfolio</a></li><li data-reactid="12"><a href="https://github.com/dacrands" data-reactid="13">Github</a></li></ul></div></div><div style="margin:0 auto;max-width:960px;padding:0px 1.0875rem 1.45rem;padding-top:0;" data-reactid="14"><div style="padding-bottom:1.45rem;" data-reactid="15"><h1 data-reactid="16">Hide Your Keys, Folks (Part II)</h1><ul class="sc-dnqmqq gBCurU" data-reactid="17"><li class="sc-iwsKbI kVPlZS" data-reactid="18">Python</li><li class="sc-iwsKbI kVPlZS" data-reactid="19">virtual environments</li><li class="sc-iwsKbI kVPlZS" data-reactid="20">pip</li><li class="sc-iwsKbI kVPlZS" data-reactid="21">Requests</li></ul><div data-reactid="22"><p>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/87/WinonaSavingsBankVault.JPG/1024px-WinonaSavingsBankVault.JPG" alt="Bank Vault"></p>
<p><em>(This blog post is a work in progress.)</em></p>
<p>In the <a href="https://dacrands.github.io/9-27-18">last installment</a>, we discussed some ways in which front-end developers can protect their API-keys. Ultimately we came to the conclusion that to truly protect your API-keys, you will need a designated back-end — a proxy server — to handle your API calls.</p>
<p>In this example we will be using <em>Flask</em> to create such an application, though the general concept can be easily applied by developers of any stack. The general idea is that our front-end application will send a request to our <em>Flask</em> app. Then our app, based on the request from the client, will send a request to the API. In doing so, we no longer need an API-key to be present in the client request since it will be handled by our back-end.</p>
<h2>Table of Contents</h2>
<hr>
<ul>
<li><a href="#prereq">Prerequisites</a></li>
<li><a href="#theApp">What we're making</a></li>
<li>
<p><a href="#env">Environments</a></p>
<ul>
<li><a href="#createEnv">Create an Environment</a></li>
<li><a href="#activeEnv">Activate an Environment</a></li>
</ul>
</li>
<li>
<p><a href="#appItUp">App It Up</a></p>
<ul>
<li><a href="#init">__init__.py</a></li>
<li><a href="#routes">routes.py</a></li>
<li><a href="#run">run.py</a></li>
<li><a href="#flaskApp">FLASK_APP</a></li>
</ul>
</li>
<li>
<p><a href="#config">Configuration</a></p>
<ul>
<li><a href="#configPy">config.py</a></li>
</ul>
</li>
</ul>
<p><a id="prereq"></a></p>
<h2>Prerequisites</h2>
<hr>
<ul>
<li>an API you're interested in and any necessary keys. <a href="https://apilist.fun/">Here a big list of APIs</a></li>
<li>Basic command-line skills</li>
<li>Python 3</li>
<li>Postman. [Here is the download] </li>
</ul>
<p>My goal is to make this tutorial accessible to front-end developers with limited back-end experience, including developers who have never used Python. Luckily, Python syntax is very semantic and intuitive, so hopefully developers from other stacks will have no problem following along with the examples used in this post.</p>
<p>If you're a back-end developer, this is not for you. You know what to do already. This is for our beginner front-end developers who want to hide their keys, nothing more.</p>
<p><a id="theApp"></a></p>
<h2>What We're Making</h2>
<hr>
<p><img src="https://i.imgur.com/8RAVXwH.png" alt="Imgur"></p>
<p>This app is an extremely minimal Flask server. We don't need a database, we just need a server to make requests to our API and pass JSON to our React/Redux app. Of course, there will be vulnerabilities in this app, but your API-key will be safe and others will take note of your effort to keep it secret (hopefully).</p>
<p>If you're looking for an in-depth introduction to Flask, Miguel Ginberg's <a href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world">Flask mega tutorial</a> is excellent.</p>
<p><a id="env"></a></p>
<h2>Environments</h2>
<hr>
<p>For any Python project, regardless of it's size or complexity, it's a good idea to create a virtual environment. This ensures that as libraries update and backwards-compatability becomes an issue, your app will still work.</p>
<p><a id="createEnv"></a></p>
<h3>Create an Environment</h3>
<p>When it comes to Python, I'm an  <a href="https://www.anaconda.com/">Anaconda</a> person. Anconda is basically Python but it comes bundled with a lot of data-science libraries and other features like <a href="http://jupyter.org/">Jupyter Notebooks</a>. I suggest you give it a try. </p>
<p>Find the <a href="https://www.anaconda.com/download">download instructions</a> for your OS and install Anaconda. If you don't use Anaconda, here are the instructions for <a href="https://packaging.python.org/guides/installing-using-pip-and-virtualenv/">creating a virtualenv with pip</a>. We will only being using <code class="language-text">conda</code>, the Anaconda CLI, for creating our environment and downloading <code class="language-text">pip</code>. After that, we will use <code class="language-text">pip</code> for everything else.</p>
<p>Now that that's out of the way, go ahead and create an environment for your Flask app using <code class="language-text">conda</code>:</p>
<div class="gatsby-highlight" data-language="commandline">
      <pre class="language-commandline"><code class="language-commandline">C:\&gt; conda create --name flaskenv</code></pre>
      </div>
<br>
<p>This will create a virtual environment named <code class="language-text">flaskenv</code>.
To see a list of your virtual environments, run the following:</p>
<div class="gatsby-highlight" data-language="commandline">
      <pre class="language-commandline"><code class="language-commandline">C:\&gt; conda info --env</code></pre>
      </div>
<br>
<p>This will print a list of your environments to the console. Learn more about <a href="https://conda.io/docs/user-guide/tasks/manage-environments.html">managing environments with conda</a>.</p>
<p><a id="activeEnv"></a></p>
<h3>Activating an Environment</h3>
<p>I will demonstrate how to activate a Python environment on a Windows OS, simply because Windows users have it hard enough as it is.</p>
<p>I love <em>PowerShell,</em> but when it comes to Python virtual-environments, you'll want to use the command prompt. We have a lot to cover in this post, so I won't go in-depth as to why we are using the latter versus the former, though I encourage you to play around with both options to discover the answer organically.</p>
<div class="gatsby-highlight" data-language="commandline">
      <pre class="language-commandline"><code class="language-commandline">C:\&gt; activate flaskenv
(flaskenv) C:\&gt; </code></pre>
      </div>
<br>
<p>Once your environment is activated, you can start installing your packages. The first package you will need is <code class="language-text">pip</code>, as this is how we will be downloading our packages. I know this may appear a bit strange to download a package-manager inside a package-manager, but it demonstrates the flexibility of using <code class="language-text">conda</code>.</p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">(flaskenv) C:\&gt; conda install pip</code></pre>
      </div>
<br>
<p>Now we can use <code class="language-text">pip</code> to install our packages, but always make sure your environment is active before doing so. If your environment is not active, not only will you be downloading all of those packages globally on your machine, but you will not be able to save the packages you use to the <code class="language-text">requirements.txt</code> file, which is used to automatically download all of the packages in your application (Think of the <code class="language-text">requirements.txt</code> as a <code class="language-text">package.json</code> because it essentially is).</p>
<p>Once you install <code class="language-text">pip</code>, you can install <code class="language-text">flask</code> using <code class="language-text">pip</code>.</p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">(flaskenv) C:\&gt; pip install flask</code></pre>
      </div>
<br>
<p>Presuming everything went smoothly, we can move on to creating our app.</p>
<p><a id="appItUp"></a></p>
<h2>App It Up</h2>
<hr>
<p>Create a new directory <code class="language-text">api-app</code> with the following structure:</p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">api-app/
  app/
    __init__.py
    routes.py
  run.py</code></pre>
      </div>
<br>
<p><a id="init"></a></p>
<h3>__init__.py</h3>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span></code></pre>
      </div>
<br>
<p>If you'd like to learn more about Python class and OOP, <a href="https://jeffknupp.com/blog/2014/06/18/improve-your-python-python-classes-and-object-oriented-programming/">this article</a> by Jeff Knupp is a good start.</p>
<p>Here we are assigning an instance of the <code class="language-text">Flask</code> class to the variable <code class="language-text">app</code>. As your app becomes more complex, you will pass this class instance to other libraries. For example:</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> flask_sqlalchemy <span class="token keyword">import</span> SQLAlchemy

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
db <span class="token operator">=</span> SQLAlchemy<span class="token punctuation">(</span>app<span class="token punctuation">)</span></code></pre>
      </div>
<p><em>Note: This example is not part of this project.</em>
<br></p>
<p>This is how inheritance works in Python. The SQLAlchemy class (the child class) instance inherits <code class="language-text">app</code> (the parent class) — this provides the child class with the attributes and methods of the parent class.</p>
<p>Passing <code class="language-text">__name__</code> to <code class="language-text">Flask</code> tells Python the proper way to execute the file. This has to do with how Python executes programs. For more information, you may reference <a href="https://stackoverflow.com/questions/419163/what-does-if-name-main-do">this stackoverflow post</a>.</p>
<p><a id="routes"></a></p>
<h3>routes.py</h3>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> app <span class="token keyword">import</span> app

@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'Hello, World!'</span></code></pre>
      </div>
<br>
<p>For brevity sake, we won't delve too much into the syntax here. Hopefully it's somewhat readily apparent what is happening here. If it's not, it will be as we create more routes.</p>
<p>Now that we have a route created, we can import our routes into our <code class="language-text">__init__.py</code> file.</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token comment"># app/__init__.py</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token keyword">from</span> app <span class="token keyword">import</span> routes</code></pre>
      </div>
<br>
<p>We place the routes import at the bottom to avoid what's known as a <em>circular dependency</em> — you can learn more about this issue <a href="https://stackabuse.com/python-circular-imports/">here</a>.</p>
<p><a id="run"></a></p>
<h3>run.py</h3>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> app <span class="token keyword">import</span> app</code></pre>
      </div>
<br>
<p>That's all the file requires. To clarify,  <code class="language-text">app</code> is the Flask instance we created in <code class="language-text">__init__.py</code>, and it is a member of the <code class="language-text">app</code> package. The <code class="language-text">app</code> package refers to the <code class="language-text">/app</code> folder in our directory, thus why in our <code class="language-text">__init__.py</code> file we are able to import our <code class="language-text">routes</code> from <code class="language-text">app</code>.</p>
<!-- ```
/app
  routes.py
``` -->
<!-- <br> -->
<p><a id="flaskApp"></a></p>
<h3>FLASK_APP</h3>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">(flaskenv) C:\api-app\&gt;set FLASK_APP=run.py</code></pre>
      </div>
<p>Flask will look for an environment <code class="language-text">FLASK_APP</code> set to, in this case, <code class="language-text">run.py</code>. This will instruct Flask on the proper way to import our application.</p>
<h3>Run it!</h3>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">(flaskenv) C:\api-app\&gt;flask run</code></pre>
      </div>
<br>
<p>If everything goes smoothly, you can visit your app at <code class="language-text">http://127:0.0.0.1:5000/</code> and hopefully see "Hello, World" in the browser.</p>
<p><a id="config"></a></p>
<h2>Configuration</h2>
<hr>
<p>We are going to add a <code class="language-text">config.py</code> file to our project. This is where the developer can define some variables that will be used throughout the application. It's a good place to create variables that the developer wants to keep secret, such as API-keys.</p>
<p>Once you add the <code class="language-text">config.py</code> file, your project structure should look something like this:</p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">api-app/
  app/
    __init__.py
    routes.py
  run.py
  config.py</code></pre>
      </div>
<br>
<p>Once we create our <code class="language-text">config.py</code>, we need to tell our <code class="language-text">app</code> to use it. Here config is referencing our file <code class="language-text">config.py</code> and not an installed library.</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token comment"># app/__init__.py</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> config <span class="token keyword">import</span> Config

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>from_object<span class="token punctuation">(</span>Config<span class="token punctuation">)</span>

<span class="token keyword">from</span> app <span class="token keyword">import</span> routes</code></pre>
      </div>
<br>
<p><a id="configPy"></a></p>
<h3>config.py</h3>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token comment"># app/config.py</span>
<span class="token keyword">import</span> os

<span class="token keyword">class</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  API_KEY <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'API_KEY'</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token string">'nice-try'</span>  </code></pre>
      </div>
<br>
<p>Recall in the first post when we used <code class="language-text">process.env.API_KEY</code> to keep the API out of version-control? Well, <code class="language-text">os.environ.get(&#39;API_KEY&#39;)</code> is doing the same thing. The configuration object will check to see if the environment variable <code class="language-text">API_KEY</code> exists, if it doesn't we provide a sarcastic fallback.</p>
<p>As a reminder, you set environment variables like this:</p>
<div class="gatsby-highlight" data-language="bash">
      <pre class="language-bash"><code class="language-bash"><span class="token comment"># Bash</span>
$ <span class="token function">export</span> API_KEY<span class="token operator">=</span>someKey</code></pre>
      </div>
<div class="gatsby-highlight" data-language="commandline">
      <pre class="language-commandline"><code class="language-commandline">:: windows
(flaskenv) C:\api-app\&gt; set API_KEY=someKey</code></pre>
      </div>
<br>
<p>As I mentioned this app is minimal, thus our <code class="language-text">config.py</code> only contains one <em>key</em>. Yes, a <em>key</em>. For JavaScript developers, you can think of our configuration object as a JS-object — a collection of <em>key</em>, <em>value</em> pairings. </p>
<p>For example, accessing the <code class="language-text">API_KEY</code> defined in our <code class="language-text">config.py</code> file will look something like this:</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> app <span class="token keyword">import</span> app

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

API_KEY <span class="token operator">=</span> app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'API_KEY'</span><span class="token punctuation">]</span></code></pre>
      </div>
<br>
<p>I hope it's becoming clearer what is taking place in our <code class="language-text">__init__.py</code> file. If not, there is no issue with treating this application as a bit of a black-box while you continue learning. I made it made it clear the purpose of this application is hiding your API-key from wrong-doers. For front-end developers with no interest in learning Python, not having a deep-understanding of Python modules is okay. In other words, this blog post is getting quite lengthy and I don't have time to elaborate on the nuances of Python here.</p>
<h2>Requests</h2>
<hr>
<p>Now that our basic Flask app is in place, we can begin creating the routes our front-end will access. For this tutorial we will only create one route, though the logic is easily replicable for additional routes.</p>
<p>To access the API, we will use the Python's <code class="language-text">requests</code> library. </p>
<p>Run the following in your terminal:</p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">(flaskenv) C:\api-app\&gt; pip install requests</code></pre>
      </div>
<br>
<h3>Lets make a request</h3>
<p>Close your app if it's running, and enter <code class="language-text">python</code> in your terminal. This will activate the Python command-line, which is where we'll explore the <code class="language-text">requests</code> library.</p>
<div class="gatsby-highlight" data-language="commandline">
      <pre class="language-commandline"><code class="language-commandline">(flaskenv) C:\api-app\&gt;python
Python 3.6.0 |Anaconda custom (64-bit)| (default, Dec 23 2016, 11:57:41) 
[MSC v.1900 64 bit (AMD64)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt;</code></pre>
      </div>
<p><em>To exit the Python terminal,  enter</em> <code class="language-text">quit()</code><em>, because</em> <code class="language-text">ctrl-c</code> <em>won't do it.</em></p>
<p>For this example, let's use an API that doesn't require a key. We will use the <a href="https://iextrading.com/developer/docs/">IEX API</a>, a free stock API.</p>
<p><strong>Copy this URL:</strong> <code class="language-text">https://api.iextrading.com/1.0/stock/market/batch?symbols=fb,f&amp;types=quote,news</code></p>
<p>Here <code class="language-text">fb</code> and <code class="language-text">f</code> are ticker symbols for Facebook and Ford, respectively. Even if you pass invalid symbol parameters (i.e., ticker symbols that don't exist), the API response will still return data for valid queries, which is really nice.</p>
<p>Let's make our first request. Enter the following in your Python terminal:</p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">&gt;&gt;&gt;import requests
&gt;&gt;&gt;res = requests.get(&#39;https://api.iextrading.com/1.0/stock/market/batch?symbols=fb,asdasdasd,f&amp;types=quote,news&#39;)</code></pre>
      </div>
<br>
<p><code class="language-text">requests.get()</code> will make a <em>GET</em> request to the passed URL and return a <code class="language-text">&lt;Response&gt;</code> object. This object will have attributes expected in an HTTP response.</p>
<p>For example, let's make sure the request was succcessful:</p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">&gt;&gt;&gt; res.status_code
200</code></pre>
      </div>
<br>
<p>If everything goes well, we get the glorious status code of <code class="language-text">200</code>.</p>
<p>Since we know our request was successful, let's take a look at the data:</p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">&gt;&gt;&gt; resJson = res.json()
&gt;&gt;&gt; resJson
{&#39;FB&#39;: {&#39;quote&#39;: {&#39;symbol&#39;: &#39;FB&#39;,&#39;companyName&#39;: &#39;Facebook Inc.&#39;&#39;primaryExchange&#39;: &#39;Nasdaq Global Select&#39; &#39;sector&#39;:
...</code></pre>
      </div>
<br>
<p>Sorry for the console dump, but you get a sense of the data. By calling <code class="language-text">res.json()</code> we can now index our data, so let's get some data that's a bit more managable:</p>
<div class="gatsby-highlight" data-language="text">
      <pre class="language-text"><code class="language-text">&gt;&gt;&gt; resJson[&#39;FB&#39;][&#39;quote&#39;][&#39;open&#39;]
145.83</code></pre>
      </div>
<p>Once you have <code class="language-text">requests</code> installed, make the following modifications to <code class="language-text">app/routes.py</code>:</p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python"><span class="token keyword">from</span> app <span class="token keyword">import</span> app
<span class="token keyword">from</span> flask <span class="token keyword">import</span> jsonify
<span class="token keyword">import</span> requests

@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>
        <span class="token string">'https://api.your-api.com/something.json?api-key={0}'</span>
        <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'API_KEY'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token keyword">if</span> res<span class="token punctuation">.</span>status_code <span class="token operator">!=</span> <span class="token number">200</span><span class="token punctuation">:</span>
        errData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'status'</span><span class="token punctuation">:</span> res<span class="token punctuation">.</span>status_code<span class="token punctuation">,</span> <span class="token string">'error'</span><span class="token punctuation">:</span> <span class="token string">'There was an error'</span><span class="token punctuation">}</span>
        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span>errData<span class="token punctuation">)</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>status_code

    apiData <span class="token operator">=</span> jsonify<span class="token punctuation">(</span>res<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> apiData</code></pre>
      </div>
<br>
<p>Let's go through this. </p>
<div class="gatsby-highlight" data-language="python">
      <pre class="language-python"><code class="language-python">res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>
        <span class="token string">'https://api.your-api.com/something.json?api-key={0}'</span>
        <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'API_KEY'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
      </div>
<br>
<h3>Introducing Postman</h3></div><a href="/blog" data-reactid="23">← Blogs page</a></div></div><button class="sc-htoDjs bSCKvV" style="display:none;" data-reactid="24">Back to Top</button><footer class="sc-bxivhb eEacBx" data-reactid="25"><a class="sc-ifAKCX dyHXzt" aria-current="false" href="/" data-reactid="26">Home</a><span data-reactid="27">∙</span><a target="_blank" href="https://github.com/dacrands" data-reactid="28">Github</a><span data-reactid="29">∙</span><a target="_blank" href="https://dcrands.com/" data-reactid="30">Portfolio</a><p data-reactid="31">Built by David Crandall using Gatsby JS</p></footer></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-10e773a9e8e479195e53.js","195351340454287":"component---src-templates-post-js-a9c836c780f858edfad9.js","162898551421021":"component---src-pages-404-js-4503918ea3a16cfcdb75.js","212839066777427":"component---src-pages-blog-js-353abcdb1a06f16b0435.js","35783957827783":"component---src-pages-index-js-35ff8869bded060a0e6f.js","78997501137040":"component---src-pages-tag-js-7377b6dcf6aa5e5c25fb.js","60335399758886":"path----bcabd757b3a04116f010.js","227493892435967":"path---8-9-18-12684389d0c8dde5020e.js","26702724923987":"path---8-18-18-1077d3371177990cc7bf.js","279523809777781":"path---10-6-18-43b6279c245b65632abe.js","246546471107980":"path---8-13-18-a90f028431e6ad5ee179.js","128175830392225":"path---8-6-18-181839d574dafb63c603.js","204011855927958":"path---8-5-18-2f8133838b691783917a.js","159838037653641":"path---8-24-18-7388c1dc9341ba18277a.js","40449485089441":"path---9-27-18-955b948bf41015f7842d.js","134703551178697":"path---8-11-18-7df658a9186d8d68f880.js","198944226089714":"path---10-7-18-b8790adc8aa4523eeade.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","49683490770531":"path---blog-c8d00b0aa9ca1fc418bb.js","142629428675168":"path---index-c8d00b0aa9ca1fc418bb.js","98043277450883":"path---tag-a0e39f21c11f6a62c5ab.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-77e2d164b005f18d2f68.js"}/*]]>*/</script><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-127816565-2', 'auto', {});
      
      }
      </script><script>/*<![CDATA[*/["/commons-b28cb5a1a06ec3a0e088.js","/app-10e773a9e8e479195e53.js","/path---10-7-18-b8790adc8aa4523eeade.js","/component---src-templates-post-js-a9c836c780f858edfad9.js","/component---src-layouts-index-js-77e2d164b005f18d2f68.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>